<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blaze Neural Coach - Championship Mindset Analysis</title>
    
    <!-- MediaPipe CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose/pose.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/face_mesh.js"></script>
    
    <!-- Three.js for 3D visualizations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <!-- Chart.js for metrics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #0d0d0d 0%, #1a1a1a 100%);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* Header */
        .header {
            background: rgba(13, 13, 13, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-bottom: 2px solid #BF5700;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .header-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            background: linear-gradient(135deg, #BF5700, #FF8C00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .status-bar {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        .status-dot.active {
            background: #00ff00;
        }
        
        .status-dot.inactive {
            background: #ff0000;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        /* Main Container */
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        /* Control Panel */
        .control-panel {
            background: rgba(26, 26, 26, 0.95);
            border: 1px solid #333;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .controls {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #BF5700, #FF8C00);
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(191, 87, 0, 0.4);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .select-wrapper {
            position: relative;
        }
        
        select {
            padding: 10px 40px 10px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #444;
            border-radius: 8px;
            color: white;
            font-size: 14px;
            appearance: none;
            cursor: pointer;
        }
        
        /* Video Analysis Section */
        .analysis-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .video-container {
            background: rgba(26, 26, 26, 0.95);
            border: 1px solid #333;
            border-radius: 12px;
            padding: 20px;
            position: relative;
        }
        
        .video-wrapper {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            background: #000;
            border-radius: 8px;
            overflow: hidden;
        }
        
        #video-input, #output-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        #video-input {
            display: none;
        }
        
        .overlay-metrics {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 8px;
            min-width: 200px;
        }
        
        .overlay-metric {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .overlay-metric .label {
            color: #999;
        }
        
        .overlay-metric .value {
            color: #BF5700;
            font-weight: 600;
        }
        
        /* Metrics Dashboard */
        .metrics-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .metric-card {
            background: rgba(26, 26, 26, 0.95);
            border: 1px solid #333;
            border-radius: 12px;
            padding: 20px;
        }
        
        .metric-card h3 {
            color: #BF5700;
            margin-bottom: 20px;
            font-size: 1.2rem;
        }
        
        .metric-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .metric-row:last-child {
            border-bottom: none;
        }
        
        .metric-value {
            font-weight: 600;
            color: #9BCBEB;
        }
        
        .metric-value.highlight {
            color: #FF8C00;
            font-size: 1.2rem;
        }
        
        /* Progress Bars */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 5px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #BF5700, #FF8C00);
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        /* Character Radar Chart */
        .chart-container {
            background: rgba(26, 26, 26, 0.95);
            border: 1px solid #333;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .chart-wrapper {
            position: relative;
            height: 400px;
        }
        
        /* Real-time Data Feed */
        .data-feed {
            background: rgba(26, 26, 26, 0.95);
            border: 1px solid #333;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .feed-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .feed-title {
            color: #BF5700;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .feed-status {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .feed-items {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .feed-item {
            padding: 15px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-left: 3px solid #BF5700;
            border-radius: 4px;
        }
        
        .feed-item-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .feed-team {
            font-weight: 600;
            color: #9BCBEB;
        }
        
        .feed-time {
            color: #666;
            font-size: 12px;
        }
        
        .feed-content {
            color: #ccc;
            font-size: 14px;
        }
        
        /* Export Section */
        .export-section {
            background: rgba(26, 26, 26, 0.95);
            border: 1px solid #333;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }
        
        .export-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 20px;
        }
        
        /* Responsive Design */
        @media (max-width: 1024px) {
            .analysis-grid {
                grid-template-columns: 1fr;
            }
            
            .metrics-dashboard {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 640px) {
            .controls {
                flex-direction: column;
                width: 100%;
            }
            
            .btn {
                width: 100%;
            }
        }
        
        /* Loading Spinner */
        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top: 3px solid #BF5700;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div class="logo">🔥 Blaze Neural Coach</div>
            <div class="status-bar">
                <div class="status-indicator">
                    <div class="status-dot inactive" id="vision-status"></div>
                    <span>Vision AI</span>
                </div>
                <div class="status-indicator">
                    <div class="status-dot inactive" id="data-status"></div>
                    <span>Live Data</span>
                </div>
                <div class="status-indicator">
                    <div class="status-dot inactive" id="ws-status"></div>
                    <span>WebSocket</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Control Panel -->
        <div class="control-panel">
            <div class="controls">
                <button class="btn" id="init-vision-ai">Start Analysis</button>
                <button class="btn" id="stop-analysis" disabled>Stop Analysis</button>
                <div class="select-wrapper">
                    <select id="sport-select">
                        <option value="baseball">Baseball</option>
                        <option value="football">Football</option>
                        <option value="basketball">Basketball</option>
                    </select>
                </div>
                <div class="select-wrapper">
                    <select id="team-select">
                        <option value="cardinals">Cardinals</option>
                        <option value="titans">Titans</option>
                        <option value="longhorns">Longhorns</option>
                        <option value="grizzlies">Grizzlies</option>
                    </select>
                </div>
                <button class="btn" id="upload-video">Upload Video</button>
                <input type="file" id="video-file" accept="video/*" style="display: none;">
            </div>
        </div>

        <!-- Video Analysis Section -->
        <div class="analysis-grid">
            <div class="video-container">
                <h3 style="margin-bottom: 20px; color: #BF5700;">Live Analysis</h3>
                <div class="video-wrapper">
                    <video id="video-input" autoplay playsinline></video>
                    <canvas id="output-canvas"></canvas>
                    <div class="overlay-metrics">
                        <div class="overlay-metric">
                            <span class="label">Form Score:</span>
                            <span class="value" id="form-score">--</span>
                        </div>
                        <div class="overlay-metric">
                            <span class="label">Balance:</span>
                            <span class="value" id="balance-score">--</span>
                        </div>
                        <div class="overlay-metric">
                            <span class="label">Power:</span>
                            <span class="value" id="power-score">--</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="video-container">
                <h3 style="margin-bottom: 20px; color: #BF5700;">3D Skeleton View</h3>
                <div class="video-wrapper">
                    <div id="three-container"></div>
                </div>
            </div>
        </div>

        <!-- Metrics Dashboard -->
        <div class="metrics-dashboard">
            <!-- Biomechanical Metrics -->
            <div class="metric-card" id="biomechanical-metrics">
                <h3>Biomechanical Analysis</h3>
                <div class="metric-row">
                    <span>Form Score:</span>
                    <span class="metric-value highlight">--/100</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="form-progress" style="width: 0%"></div>
                </div>
                <div class="metric-row">
                    <span>Hip Rotation:</span>
                    <span class="metric-value">--°</span>
                </div>
                <div class="metric-row">
                    <span>Shoulder Tilt:</span>
                    <span class="metric-value">--°</span>
                </div>
                <div class="metric-row">
                    <span>Balance:</span>
                    <span class="metric-value">--%</span>
                </div>
                <div class="metric-row">
                    <span>Explosiveness:</span>
                    <span class="metric-value">--%</span>
                </div>
            </div>

            <!-- Micro-Expression Metrics -->
            <div class="metric-card" id="micro-expression-metrics">
                <h3>Micro-Expression Analysis</h3>
                <div class="metric-row">
                    <span>Eye Focus:</span>
                    <span class="metric-value">--</span>
                </div>
                <div class="metric-row">
                    <span>Jaw Tension:</span>
                    <span class="metric-value">--</span>
                </div>
                <div class="metric-row">
                    <span>Brow Furrow:</span>
                    <span class="metric-value">--</span>
                </div>
                <div class="metric-row">
                    <span>Blink Rate:</span>
                    <span class="metric-value">--/min</span>
                </div>
            </div>

            <!-- Character Assessment -->
            <div class="metric-card" id="character-metrics">
                <h3>Character Assessment</h3>
                <div class="metric-row">
                    <span>Championship Mindset:</span>
                    <span class="metric-value highlight">--/100</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="mindset-progress" style="width: 0%"></div>
                </div>
                <div class="metric-row">
                    <span>Grit:</span>
                    <span class="metric-value">--%</span>
                </div>
                <div class="metric-row">
                    <span>Determination:</span>
                    <span class="metric-value">--%</span>
                </div>
                <div class="metric-row">
                    <span>Focus:</span>
                    <span class="metric-value">--%</span>
                </div>
                <div class="metric-row">
                    <span>Mental Toughness:</span>
                    <span class="metric-value">--%</span>
                </div>
            </div>

            <!-- Team Intelligence -->
            <div class="metric-card" id="team-intelligence">
                <h3>Team Intelligence</h3>
                <div class="metric-row">
                    <span>Blaze Score:</span>
                    <span class="metric-value highlight">--</span>
                </div>
                <div class="metric-row">
                    <span>Readiness:</span>
                    <span class="metric-value">--%</span>
                </div>
                <div class="metric-row">
                    <span>Momentum:</span>
                    <span class="metric-value">--</span>
                </div>
                <div class="metric-row">
                    <span>Win Probability:</span>
                    <span class="metric-value">--%</span>
                </div>
            </div>
        </div>

        <!-- Character Radar Chart -->
        <div class="chart-container">
            <h3 style="margin-bottom: 20px; color: #BF5700;">Character Profile</h3>
            <div class="chart-wrapper">
                <canvas id="character-radar"></canvas>
            </div>
        </div>

        <!-- Real-time Data Feed -->
        <div class="data-feed">
            <div class="feed-header">
                <div class="feed-title">Live Sports Intelligence</div>
                <div class="feed-status">
                    <span id="feed-count">0</span> updates
                    <div class="status-dot inactive" id="feed-status"></div>
                </div>
            </div>
            <div class="feed-items" id="feed-items">
                <!-- Feed items will be added dynamically -->
            </div>
        </div>

        <!-- Export Section -->
        <div class="export-section">
            <h3 style="margin-bottom: 10px; color: #BF5700;">Export Analysis Report</h3>
            <p style="color: #999; margin-bottom: 20px;">Download comprehensive analysis data for coaching insights</p>
            <div class="export-buttons">
                <button class="btn" id="export-json">Export JSON</button>
                <button class="btn" id="export-csv">Export CSV</button>
                <button class="btn" id="export-pdf">Generate PDF Report</button>
            </div>
        </div>
    </div>

    <!-- Load Blaze Vision AI -->
    <script src="js/blaze-vision-ai.js"></script>
    
    <!-- Load Cursor Integration -->
    <script src="js/cursor-ide-integration.js"></script>
    
    <!-- Main Application Script -->
    <script>
        // Global variables
        let blazeVisionAI = null;
        let cursorIntegration = null;
        let characterChart = null;
        let threeScene = null;
        let isAnalyzing = false;
        let wsConnections = new Map();
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('🚀 Initializing Blaze Neural Coach...');
            
            // Initialize systems
            await initializeSystems();
            
            // Setup event listeners
            setupEventListeners();
            
            // Initialize charts
            initializeCharts();
            
            // Start WebSocket connections
            await connectWebSockets();
            
            console.log('✅ Blaze Neural Coach ready');
        });
        
        // Initialize core systems
        async function initializeSystems() {
            try {
                // Initialize Vision AI
                blazeVisionAI = new BlazeVisionAI();
                
                // Initialize Cursor Integration
                cursorIntegration = new CursorIDEIntegration();
                
                // Initialize Three.js scene
                initializeThreeJS();
                
            } catch (error) {
                console.error('Failed to initialize systems:', error);
            }
        }
        
        // Setup event listeners
        function setupEventListeners() {
            // Start/Stop Analysis
            document.getElementById('init-vision-ai').addEventListener('click', startAnalysis);
            document.getElementById('stop-analysis').addEventListener('click', stopAnalysis);
            
            // Upload video
            document.getElementById('upload-video').addEventListener('click', () => {
                document.getElementById('video-file').click();
            });
            
            document.getElementById('video-file').addEventListener('change', handleVideoUpload);
            
            // Sport/Team selection
            document.getElementById('sport-select').addEventListener('change', handleSportChange);
            document.getElementById('team-select').addEventListener('change', handleTeamChange);
            
            // Export functions
            document.getElementById('export-json').addEventListener('click', exportJSON);
            document.getElementById('export-csv').addEventListener('click', exportCSV);
            document.getElementById('export-pdf').addEventListener('click', exportPDF);
        }
        
        // Start analysis
        async function startAnalysis() {
            if (isAnalyzing) return;
            
            try {
                console.log('Starting analysis...');
                
                // Update UI
                document.getElementById('init-vision-ai').disabled = true;
                document.getElementById('stop-analysis').disabled = false;
                document.getElementById('vision-status').classList.add('active');
                document.getElementById('vision-status').classList.remove('inactive');
                
                // Initialize Vision AI
                await blazeVisionAI.initialize();
                
                // Start cursor integration
                await cursorIntegration.initialize();
                
                isAnalyzing = true;
                
                // Start metric updates
                startMetricUpdates();
                
            } catch (error) {
                console.error('Failed to start analysis:', error);
                alert('Failed to start analysis. Please check camera permissions.');
            }
        }
        
        // Stop analysis
        function stopAnalysis() {
            if (!isAnalyzing) return;
            
            console.log('Stopping analysis...');
            
            // Update UI
            document.getElementById('init-vision-ai').disabled = false;
            document.getElementById('stop-analysis').disabled = true;
            document.getElementById('vision-status').classList.remove('active');
            document.getElementById('vision-status').classList.add('inactive');
            
            isAnalyzing = false;
            
            // Stop video stream if exists
            const videoElement = document.getElementById('video-input');
            if (videoElement.srcObject) {
                videoElement.srcObject.getTracks().forEach(track => track.stop());
                videoElement.srcObject = null;
            }
        }
        
        // Handle video upload
        function handleVideoUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const url = URL.createObjectURL(file);
                const videoElement = document.getElementById('video-input');
                videoElement.src = url;
                videoElement.play();
            }
        }
        
        // Handle sport change
        function handleSportChange(event) {
            const sport = event.target.value;
            console.log('Sport changed to:', sport);
            
            // Update team options based on sport
            updateTeamOptions(sport);
        }
        
        // Handle team change
        function handleTeamChange(event) {
            const team = event.target.value;
            console.log('Team changed to:', team);
            
            // Update data feeds
            updateDataFeeds(team);
        }
        
        // Update team options
        function updateTeamOptions(sport) {
            const teamSelect = document.getElementById('team-select');
            teamSelect.innerHTML = '';
            
            const teams = {
                baseball: ['Cardinals', 'Dodgers', 'Yankees', 'Astros'],
                football: ['Titans', 'Chiefs', 'Bills', 'Cowboys'],
                basketball: ['Grizzlies', 'Lakers', 'Celtics', 'Warriors']
            };
            
            teams[sport].forEach(team => {
                const option = document.createElement('option');
                option.value = team.toLowerCase();
                option.textContent = team;
                teamSelect.appendChild(option);
            });
        }
        
        // Initialize charts
        function initializeCharts() {
            const ctx = document.getElementById('character-radar').getContext('2d');
            
            characterChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Grit', 'Determination', 'Focus', 'Confidence', 'Mental Toughness', 'Pressure Response'],
                    datasets: [{
                        label: 'Character Profile',
                        data: [0, 0, 0, 0, 0, 0],
                        backgroundColor: 'rgba(191, 87, 0, 0.2)',
                        borderColor: '#BF5700',
                        borderWidth: 2,
                        pointBackgroundColor: '#BF5700',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#BF5700'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                color: '#999'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            pointLabels: {
                                color: '#fff',
                                font: {
                                    size: 12
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }
        
        // Initialize Three.js
        function initializeThreeJS() {
            const container = document.getElementById('three-container');
            if (!container) return;
            
            // Create scene
            threeScene = new THREE.Scene();
            threeScene.background = new THREE.Color(0x0d0d0d);
            
            // Create camera
            const camera = new THREE.PerspectiveCamera(
                75,
                container.clientWidth / container.clientHeight,
                0.1,
                1000
            );
            camera.position.z = 5;
            
            // Create renderer
            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            container.appendChild(renderer.domElement);
            
            // Add lights
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            threeScene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.4);
            directionalLight.position.set(1, 1, 1);
            threeScene.add(directionalLight);
            
            // Animation loop
            function animate() {
                requestAnimationFrame(animate);
                renderer.render(threeScene, camera);
            }
            animate();
        }
        
        // Connect WebSockets
        async function connectWebSockets() {
            const sports = ['mlb', 'nfl', 'nba'];
            
            sports.forEach(sport => {
                connectToSport(sport);
            });
        }
        
        // Connect to sport WebSocket
        function connectToSport(sport) {
            const wsUrl = `wss://blaze-intelligence.pages.dev/ws/${sport}`;
            const ws = new WebSocket(wsUrl);
            
            ws.onopen = () => {
                console.log(`Connected to ${sport.toUpperCase()} stream`);
                document.getElementById('ws-status').classList.add('active');
                document.getElementById('ws-status').classList.remove('inactive');
                wsConnections.set(sport, ws);
            };
            
            ws.onmessage = (event) => {
                const data = JSON.parse(event.data);
                handleWebSocketData(sport, data);
            };
            
            ws.onerror = (error) => {
                console.error(`${sport.toUpperCase()} WebSocket error:`, error);
            };
            
            ws.onclose = () => {
                console.log(`${sport.toUpperCase()} connection closed`);
                wsConnections.delete(sport);
                
                // Retry connection after 5 seconds
                setTimeout(() => connectToSport(sport), 5000);
            };
        }
        
        // Handle WebSocket data
        function handleWebSocketData(sport, data) {
            // Update data status
            document.getElementById('data-status').classList.add('active');
            document.getElementById('data-status').classList.remove('inactive');
            
            // Add to feed
            addFeedItem(sport, data);
            
            // Update team intelligence if relevant
            if (data.blazeMetrics) {
                updateTeamIntelligence(data.blazeMetrics);
            }
        }
        
        // Add feed item
        function addFeedItem(sport, data) {
            const feedItems = document.getElementById('feed-items');
            const feedCount = document.getElementById('feed-count');
            
            const item = document.createElement('div');
            item.className = 'feed-item';
            item.innerHTML = `
                <div class="feed-item-header">
                    <span class="feed-team">${sport.toUpperCase()}</span>
                    <span class="feed-time">${new Date().toLocaleTimeString()}</span>
                </div>
                <div class="feed-content">
                    ${data.blazeMetrics ? `Blaze Score: ${data.blazeMetrics.blazeScore}` : 'Data update received'}
                </div>
            `;
            
            feedItems.insertBefore(item, feedItems.firstChild);
            
            // Keep only last 10 items
            while (feedItems.children.length > 10) {
                feedItems.removeChild(feedItems.lastChild);
            }
            
            // Update count
            const currentCount = parseInt(feedCount.textContent);
            feedCount.textContent = currentCount + 1;
            
            // Update feed status
            document.getElementById('feed-status').classList.add('active');
            setTimeout(() => {
                document.getElementById('feed-status').classList.remove('active');
            }, 1000);
        }
        
        // Update team intelligence
        function updateTeamIntelligence(metrics) {
            const card = document.getElementById('team-intelligence');
            
            if (metrics.blazeScore) {
                card.querySelector('.metric-row:nth-child(1) .metric-value').textContent = metrics.blazeScore;
            }
            if (metrics.readiness) {
                card.querySelector('.metric-row:nth-child(2) .metric-value').textContent = metrics.readiness + '%';
            }
            if (metrics.momentum !== undefined) {
                card.querySelector('.metric-row:nth-child(3) .metric-value').textContent = 
                    (metrics.momentum > 0 ? '+' : '') + metrics.momentum;
            }
        }
        
        // Start metric updates
        function startMetricUpdates() {
            setInterval(() => {
                if (!isAnalyzing || !blazeVisionAI) return;
                
                const metrics = blazeVisionAI.exportMetrics();
                
                // Update biomechanical display
                if (metrics.biomechanical) {
                    updateBiomechanicalDisplay(metrics.biomechanical);
                }
                
                // Update character display
                if (metrics.character) {
                    updateCharacterDisplay(metrics.character);
                    updateCharacterChart(metrics.character);
                }
                
                // Update overlay
                updateOverlayMetrics(metrics);
                
            }, 100); // Update every 100ms
        }
        
        // Update biomechanical display
        function updateBiomechanicalDisplay(metrics) {
            const card = document.getElementById('biomechanical-metrics');
            
            if (metrics.formScore !== undefined) {
                card.querySelector('.metric-row:nth-child(1) .metric-value').textContent = `${metrics.formScore}/100`;
                document.getElementById('form-progress').style.width = `${metrics.formScore}%`;
                document.getElementById('form-score').textContent = metrics.formScore;
            }
            
            if (metrics.hipRotation !== undefined) {
                card.querySelector('.metric-row:nth-child(3) .metric-value').textContent = `${metrics.hipRotation.toFixed(1)}°`;
            }
            
            if (metrics.shoulderTilt !== undefined) {
                card.querySelector('.metric-row:nth-child(4) .metric-value').textContent = `${metrics.shoulderTilt.toFixed(1)}°`;
            }
            
            if (metrics.balance !== undefined) {
                card.querySelector('.metric-row:nth-child(5) .metric-value').textContent = `${metrics.balance.toFixed(0)}%`;
                document.getElementById('balance-score').textContent = `${metrics.balance.toFixed(0)}%`;
            }
            
            if (metrics.explosiveness !== undefined) {
                card.querySelector('.metric-row:nth-child(6) .metric-value').textContent = `${metrics.explosiveness.toFixed(0)}%`;
                document.getElementById('power-score').textContent = `${metrics.explosiveness.toFixed(0)}%`;
            }
        }
        
        // Update character display
        function updateCharacterDisplay(traits) {
            const card = document.getElementById('character-metrics');
            
            if (traits.championshipMindset !== undefined) {
                card.querySelector('.metric-row:nth-child(1) .metric-value').textContent = `${traits.championshipMindset.toFixed(0)}/100`;
                document.getElementById('mindset-progress').style.width = `${traits.championshipMindset}%`;
            }
            
            if (traits.grit !== undefined) {
                card.querySelector('.metric-row:nth-child(3) .metric-value').textContent = `${traits.grit.toFixed(0)}%`;
            }
            
            if (traits.determination !== undefined) {
                card.querySelector('.metric-row:nth-child(4) .metric-value').textContent = `${traits.determination.toFixed(0)}%`;
            }
            
            if (traits.focus !== undefined) {
                card.querySelector('.metric-row:nth-child(5) .metric-value').textContent = `${traits.focus.toFixed(0)}%`;
            }
            
            if (traits.mentalToughness !== undefined) {
                card.querySelector('.metric-row:nth-child(6) .metric-value').textContent = `${traits.mentalToughness.toFixed(0)}%`;
            }
        }
        
        // Update character chart
        function updateCharacterChart(traits) {
            if (!characterChart) return;
            
            characterChart.data.datasets[0].data = [
                traits.grit || 0,
                traits.determination || 0,
                traits.focus || 0,
                traits.confidence || 0,
                traits.mentalToughness || 0,
                traits.pressureResponse || 0
            ];
            
            characterChart.update();
        }
        
        // Update overlay metrics
        function updateOverlayMetrics(metrics) {
            // These are updated in other functions
        }
        
        // Update data feeds
        function updateDataFeeds(team) {
            // Filter feeds based on team selection
            console.log('Updating feeds for team:', team);
        }
        
        // Export functions
        function exportJSON() {
            if (!blazeVisionAI) {
                alert('Please start analysis first');
                return;
            }
            
            const data = blazeVisionAI.exportMetrics();
            const json = JSON.stringify(data, null, 2);
            
            downloadFile('blaze-analysis.json', json, 'application/json');
        }
        
        function exportCSV() {
            if (!blazeVisionAI) {
                alert('Please start analysis first');
                return;
            }
            
            const data = blazeVisionAI.exportMetrics();
            let csv = 'Metric,Value\n';
            
            // Flatten the data structure
            if (data.biomechanical) {
                Object.entries(data.biomechanical).forEach(([key, value]) => {
                    csv += `Biomechanical_${key},${value}\n`;
                });
            }
            
            if (data.character) {
                Object.entries(data.character).forEach(([key, value]) => {
                    csv += `Character_${key},${value}\n`;
                });
            }
            
            csv += `BlazeScore,${data.blazeScore || 0}\n`;
            
            downloadFile('blaze-analysis.csv', csv, 'text/csv');
        }
        
        function exportPDF() {
            alert('PDF export will be available in the next update');
        }
        
        // Helper function to download files
        function downloadFile(filename, content, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>